<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Record 6b — Weekly Cleaning Schedule</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { width: 700px; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #333; padding: 6px; text-align: center; }
    th { background: #f2f2f2; }
    .controls { margin-bottom: 15px; }
    .controls button { margin-right: 10px; padding: 6px 12px; }
    @media print {
      body { margin: 10mm; }
      table { width: 100%; }
    }
  </style>
</head>
<body>
  <div class="controls">
    <label>Week Commencing: <input type="date" id="weekDate"></label>
    <button onclick="archiveData()">Archive</button>
    <button onclick="clearData()">Clear</button>
    <button onclick="window.print()">Print</button>
    <button onclick="history.back()">Back</button>
  </div>

  <h2>Record 6b — Weekly Cleaning Schedule</h2>

  <table id="weeklyTable">
    <tr>
      <th>Task</th>
      <th>M</th><th>T</th><th>W</th><th>T</th><th>F</th>
    </tr>
    <tr><td>Clean out fridge (shelves & doors)</td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td></tr>
    <tr><td>Clean inside of ovens</td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td></tr>
    <tr><td>Chemical cupboard (refill if needed)</td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td></tr>
    <tr><td>Clean pantry (check expiry, wipe shelves & sill)</td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td></tr>
    <tr><td>Sweep & mop pantry floor</td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td><td><input type="checkbox"></td></tr>
  </table>

  <script>
    const STORAGE_KEY = "weeklyCleaning6b";

    function saveData() {
      const checkboxes = document.querySelectorAll("input[type='checkbox']");
      let data = Array.from(checkboxes).map(cb => cb.checked);
      localStorage.setItem(STORAGE_KEY, JSON.stringify({
        week: document.getElementById("weekDate").value,
        checks: data
      }));
    }

    function loadData() {
      const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));
      if (saved) {
        document.getElementById("weekDate").value = saved.week;
        const checkboxes = document.querySelectorAll("input[type='checkbox']");
        saved.checks.forEach((val, i) => { checkboxes[i].checked = val; });
      }
    }

    function archiveData() {
      const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));
      if (!saved) { alert("Nothing to archive"); return; }
      const blob = new Blob([JSON.stringify(saved, null, 2)], {type: "application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "weekly_cleaning_archive.json";
      a.click();
      URL.revokeObjectURL(url);
      clearData();
    }

    function clearData() {
      localStorage.removeItem(STORAGE_KEY);
      location.reload();
    }

    // auto-save every time a box is ticked or date changed
    document.addEventListener("change", saveData);
    window.onload = loadData;
  </script>
</body>
</html>
