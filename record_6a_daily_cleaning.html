<!doctype html>
<html lang="en">
<head>
  <!-- üîí MDK auth guard + 30-min inactivity logout -->
<style id="mdk-hide">html{visibility:hidden}</style>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script>
(function(){
  const cfg = {
    apiKey: "AIzaSyDxnmPRp_Kr_FZj9Q_E8Dy1cxv1_D2kWhQ",
    authDomain: "mother-duck-kitchen.firebaseapp.com",
    projectId: "mother-duck-kitchen",
    storageBucket: "mother-duck-kitchen.appspot.com",
    messagingSenderId: "925762762893",
    appId: "1:925762762893:web:715285c11b9b30c9bccac4",
    measurementId: "G-1EGZ0PWQYE"
  };
  if (!firebase.apps.length) firebase.initializeApp(cfg);
  const auth = firebase.auth();

  // 30-minute inactivity
  const TIMEOUT = 30*60*1000; let t;
  function reset(){ clearTimeout(t); t = setTimeout(()=>auth.signOut().then(()=>location.replace("login.html?msg=expired")), TIMEOUT); }
  ["click","keydown","mousemove","touchstart","scroll","focus"].forEach(e=>window.addEventListener(e, reset, {passive:true}));

  auth.onAuthStateChanged(u=>{
    if(!u){ location.replace("login.html"); }
    else { document.getElementById("mdk-hide")?.remove(); reset(); window.mdkLogout = () => auth.signOut().then(()=>location.replace("login.html")); }
  });
})();
</script>
<!-- üîí end guard --><meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Record 6a ‚Äì Daily Cleaning Checklist</title>
<style>
  body{margin:0;font-family:Arial,sans-serif;background:#f9fafb;color:#111827}
  .wrap{max-width:800px;margin:20px auto;padding:16px;background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1)}
  .topbar{display:flex;gap:10px;margin-bottom:12px}
  .btn{border:0;padding:8px 14px;border-radius:8px;font-weight:600;cursor:pointer}
  .btn--back{background:#ffc107;color:#000}
  .btn--primary{background:#0d6efd;color:#fff}
  h1{text-align:center;font-size:20px;margin:10px 0 16px}
  label{font-weight:600;margin-right:6px}
  .meta{display:flex;gap:16px;justify-content:center;margin-bottom:14px;flex-wrap:wrap}
  table{width:100%;border-collapse:collapse;border:1px solid #e5e7eb;border-radius:8px;overflow:hidden}
  th,td{border:1px solid #e5e7eb;padding:8px;text-align:left}
  th{background:#f3f4f6}
  td.check{text-align:center;width:60px}
  input[type="checkbox"]{width:20px;height:20px}
  @page{size:A4 portrait;margin:12mm}
  @media print{.topbar{display:none} body{background:#fff}}
</style>
</head>
<body>
<div class="wrap">
  <div class="topbar">
    <a href="kitchen.html"><button class="btn btn--back">‚Üê Back</button></a>
    <button class="btn" onclick="window.print()">Print</button>
    <button class="btn" onclick="clearForm()">Clear</button>
    <button class="btn btn--primary" onclick="saveForm()">Save</button>
  </div>
  <h1>Record 6a ‚Äì Daily Cleaning Checklist</h1>

  <!-- Date + Staff meta -->
  <div class="meta">
    <div><label for="cleanDate">Date:</label><input type="date" id="cleanDate"></div>
    <div><label for="staff">Staff:</label><input type="text" id="staff" placeholder="Name / Initials"></div>
  </div>

  <table id="dailyClean">
    <thead>
      <tr><th>Area / Task</th><th class="check">Done</th></tr>
    </thead>
    <tbody>
      <tr><td>Kitchen benches and prep surfaces</td><td class="check"><input type="checkbox"></td></tr>
      <tr><td>Sinks and taps</td><td class="check"><input type="checkbox"></td></tr>
      <tr><td>Utensils and small equipment</td><td class="check"><input type="checkbox"></td></tr>
      <tr><td>Floors swept and mopped</td><td class="check"><input type="checkbox"></td></tr>
      <tr><td>Fridge handles and seals wiped</td><td class="check"><input type="checkbox"></td></tr>
      <tr><td>Waste bins emptied and cleaned</td><td class="check"><input type="checkbox"></td></tr>
      <tr><td>Dishwasher cleaned after use</td><td class="check"><input type="checkbox"></td></tr>
      <tr><td>Walls / splashbacks as required</td><td class="check"><input type="checkbox"></td></tr>
      <tr><td>Other areas as per schedule</td><td class="check"><input type="checkbox"></td></tr>
    </tbody>
  </table>
</div>

<script>
const KEY='mdk_cleaning_daily';

function saveForm(){
  const data={
    date:document.getElementById('cleanDate').value,
    staff:document.getElementById('staff').value,
    checks:Array.from(document.querySelectorAll('#dailyClean input[type=checkbox]')).map(c=>c.checked)
  };
  localStorage.setItem(KEY,JSON.stringify(data));
  alert('Saved');
}

function loadForm(){
  const raw=localStorage.getItem(KEY); if(!raw) return;
  try{
    const d=JSON.parse(raw);
    if(d.date) document.getElementById('cleanDate').value=d.date;
    if(d.staff) document.getElementById('staff').value=d.staff;
    const boxes=document.querySelectorAll('#dailyClean input[type=checkbox]');
    (d.checks||[]).forEach((v,i)=>{if(boxes[i]) boxes[i].checked=!!v});
  }catch(e){}
}

function clearForm(){
  document.getElementById('cleanDate').value='';
  document.getElementById('staff').value='';
  document.querySelectorAll('#dailyClean input[type=checkbox]').forEach(c=>c.checked=false);
  localStorage.removeItem(KEY);
}

window.addEventListener('load',loadForm);
</script>
</body>
</html>
